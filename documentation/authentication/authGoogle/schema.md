## 1. Ініціація входу (фронтенд)

- Користувач натискає кнопку "Продовжити з Google" у модальному вікні (`SocialAuthFooter.tsx`).
- Фронтенд викликає функцію з хука `useGoogleSignIn`, яка перенаправляє користувача на сторінку авторизації Google через Supabase.
- Supabase автоматично генерує URL для входу через Google OAuth і перенаправляє користувача на сторінку Google для авторизації.

## 2. Авторизація через Google

- Користувач входить у свій Google-акаунт і дає згоду на доступ до даних (email, профіль).
- Google перенаправляє користувача назад на твій додаток, на URL, який ти вказав у налаштуваннях Supabase (`app/api/auth/google/callback`).

## 3. Обробка callback (бекенд)

- Бекенд через роут `app/api/auth/google/callback` отримує код авторизації від Google через Supabase.
- Supabase обробляє цей код і створює або оновлює користувача в `auth.users` (Supabase Auth).
- Бекенд створює або оновлює користувача в базі даних (`public.User` у Prisma) з відповідним `supabaseId`.
- Бекенд генерує токени (`access token` і `refresh token`) для користувача і перенаправляє його на фронтенд із цими токенами.

## 4. Обробка на фронтенді

- Фронтенд отримує токени через query-параметри в URL і зберігає їх у стані `authStore`.
- Фронтенд робить запит до бекенду (наприклад, /api/auth/user/me), щоб отримати повні дані користувача, використовуючи `access token`. Дані користувача зберігаються в стані `authStore`, і користувач вважається авторизованим.

## 5. Безпека

- Уся логіка автентифікації (обмін кодами, створення токенів) відбувається на бекенді, щоб уникнути витоку чутливих даних (`client secret` тощо).
- Токени зберігаються в localStorage із захистом від XSS.

## 6. Використання React Query

- Функція`useUserQuery` із хука `useAuthQueries.ts` використовується для автоматичного оновлення даних користувача після авторизації.
- Функція `useEmailLoginMutation` із хука `useAuthQueries.ts` адаптована для Google-авторизації, щоб зробити код більш уніфікованим.
